<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Alphabet Tracing</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      text-align: center;
      background-color: #605678;
    }
    .alphabet-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      padding: 20px;
    }
    .alphabet-button {
      margin: 5px;
      padding: 10px 15px;
      font-size: 16px;
      background-color: #8ABFA3;
      border: 2px solid #FFBF61;
      border-radius: 5px;
      cursor: pointer;
    }
    .alphabet-button:hover {
      background-color: #640D5F;
      color: wheat;
    }
    #myCanvas {
      border: 2px solid #FFBF61;
      background-color: #8ABFA3;
      display: block;
      margin: 20px auto;
    }
    button {
      margin: 10px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      border: 2px solid darkblue;
      background-color: goldenrod;
      border-radius: 5px;
    }
    button:hover {
      background-color: darkblue;
      color: white;
    }
    #relatedImage {
      display: none;
      margin-top: 20px;
      width: 200px;
      height: auto;
    }
    #appreciationMessage {
      font-size: 24px;
      font-weight: bold;
      color: #fff4b7;
      margin-top: 5px;
    }
  </style>
</head>
<body>

<div id="page">
  <h1>Svensk Alfabet</h1>
  <div class="alphabet-container" id="alphabetButtons"></div>
  <canvas id="myCanvas" width="300" height="300"></canvas>
  <div id="appreciationMessage"></div>
  <button id="resetBtn">Reset</button>
  <img id="relatedImage" alt="Related image">
</div>
 <script> 
  //Creating variables on the top
  //Creating variable for Swedish alphabets and make them split
  var letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZÅÄÖ".split('');
  //Creating variable for related images
  var letterImages = {
    A: "anka.png", B: "ballong.png", C: "cykel.png", D: "dinosaurie.png", E: "elefant.png",
    F: "fisk.png", G: "godis.png", H: "hatt.png", I: "igelkott.png", J: "jultomte.png",
    K: "krabba.png", L: "lampa.png", M: "mus.png", N: "nyckelpiga.png", O: "orm.png",
    P: "pingvin.png", Q: "quilta.png", R: "raket.png", S: "sol.png", T: "tåg.png",
    U: "uggla.png", V: "val.png", W: "whale.png", X: "xylophone.png", Y: "yxa.png",
    Z: "zebra.png", Å: "asna.png", Ä: "apple.png", Ö: "odla.png"
  };
  //Creating variables on the top
  //Creating variable for Alphabet buttons and get element by id
  var alphabetButtons = document.getElementById('alphabetButtons');
  //Creatig variable for canvas
  var canvas = document.getElementById('myCanvas');
  //Creating variable for context
  var ctx = canvas.getContext('2d');
  //Creating variable for reset Button
  var resetBtn = document.getElementById('resetBtn');
  //Defining related image as a variable and get element by id 
  var relatedImage = document.getElementById('relatedImage');
  //Variable for appreciation
  var appreciationMessage = document.getElementById('appreciationMessage');
  
  //Creating variables for off-screen
  //Variable for off-screen canvas and shows it on the main screen 
  var offscreenCanvas = document.createElement('canvas');
  //Variable for off-screen context
  var offscreenCtx = offscreenCanvas.getContext('2d');
  //Adjusting off-screen width & height with canvas height & width
  offscreenCanvas.width = canvas.width;
  offscreenCanvas.height = canvas.height;

  //Tracks traced pixels
  //Creating variable for selected letter set A as a default
  var selectedLetter = 'A';
  //Creating variable for traced pixels and make a new set 
  var tracedPixels = new Set();
  //Setting variable for drawing to be false as a default
  var isDrawing = false, lastX = 0, lastY = 0;

  //Generate buttons for all the letters
  letters.forEach(letter => {
    //Get element by button id
    var button = document.createElement('button');
    //Display letter on button
    button.textContent = letter;
    //Applying styles
    button.className = 'alphabet-button';
    button.addEventListener('click', () => {
    //Update the selected letter
    selectedLetter = letter;
    //Reset the canvas 
    resetCanvas();
    drawLetter(letter);
    });
    alphabetButtons.appendChild(button);
  });

    //Creating a function to draw the letter 
    function drawLetter(letter) {
    //Clear the entire visible canvas
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    //Clear the entire off-screen canvas
    offscreenCtx.clearRect(0, 0, offscreenCanvas.width, offscreenCanvas.height);
    //Setting font and styles for the letter 
    ctx.font = "bold 200px Arial";
    ctx.strokeStyle = "#605678";
    ctx.lineWidth = 2;

    //Calculating the position for centered text 
    const x = canvas.width / 2 - 60;
    const y = canvas.height / 2 + 60;

    //Draw the letter on both canvases
    //Visible for user 
    ctx.strokeText(letter, x, y);
    //Invisible used for checking on off-screen
    offscreenCtx.font = "bold 200px Arial";
    offscreenCtx.fillStyle = "black";
    offscreenCtx.fillText(letter, x, y);
    }
   
   //Converting x & y coordinates to a unique key
   //Allows us to efficiently track which pixels have been traced
   function pixelToKey(x, y) {
   return `${x},${y}`;
   }

  //Creating function to check if pixel is part of letter
  function isPixelInLetter(x, y) {
  var pixelData = offscreenCtx.getImageData(x, y, 1, 1).data;
  //Non-transparent pixels
  return pixelData[3] > 0;
  }

  //Function to calculate and return the x and y coordinates of a user event relative to the canvas
  function getCoordinates(event) {
  //Get the bounding rectangle of the canvas
  //This provides the canvas's position and size relative to the viewport
  var rect = canvas.getBoundingClientRect();
    
  // Check if the event is a touch event (used for mobile devices)
  if (event.touches) {
  // For touch events, use the first touch point's clientX and clientY coordinates
  // Subtract the canvas's left and top offsets to get coordinates relative to the canvas
   return {
        x: event.touches[0].clientX - rect.left,
        y: event.touches[0].clientY - rect.top,
      };
    }
    // For mouse events, directly use the event's offsetX and offsetY properties
    // These give the position of the cursor relative to the canvas
    return {
      x: event.offsetX,
      y: event.offsetY,
    };
  }

 //Start drawing if the click begins on the letter 
  //At this point, the user can now drag to draw within the letter boundaries
  //If the pixel is not part of the letter, the user cannot start drawing
  //This avoids drawing outside the letter's boundaries
  function startDrawing(event) {
  // Prevent default behaviour to avoid issues with touch scrolling or browser actions
  event.preventDefault();
  // Get the x and y coordinates of the click or touch event relative to the canvas
  var { x, y } = getCoordinates(event);
    
  // Check if the clicked or touched pixel is part of the letter
  if (isPixelInLetter(x, y)) {
  // If the pixel is part of the letter, enable drawing mode
  isDrawing = true;
  // Store the starting coordinates to track the user's drawing path
  lastX = x;
  lastY = y;
    }
  }
   
    
   </script>
